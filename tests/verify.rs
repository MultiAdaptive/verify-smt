use verify_smt::h256::H256;
use verify_smt::merkle_verify::MerkleVerify;

#[test]
fn test_verify_proof() {
    /*
    proof: "4c4ff551f55b1a5a404ebfc983b23a0ba3cba0bc20e8fb7ecfe6ce8da55346c01b196c6ac6c4d9c801cd7d2829581aefe84b6a754368e0aa9397fbd76363875a63307108004f014c4ff74851066219da8bfe824fdb5e2b5b37f73d0afaa76d285d65c34c8c0f1452fad96891a8000000000000000000000000000000000000000000000000000000000000d00050af9f3f2553576bab14c22f7a42cd5aea429d5f3096a895f3c89af33c3393321850f20109dd0ba9aeec178bcc2cad77d88f25d361b29dda5b5e84d3a9e0f51ef8ac506ea8b740a53bdcac14ac1239d25520ec5f30522d91ae80697d1f2cf5ca8b471650240042f461547f2cdfd34e7cc57b6eaf9c4b2cdd0383d23a08dd035e0c01c49b503c72377fe7d057c7bc8ab964a00cbc699c08399b9c8fcc601a9865fa1f4b1f4450bd5faa039f16a100567372fdd133b71b4e5d104b52b1b5ff4e1637405f723b4f4c4ff651035829020e2ef6b2d4677f8894e37972556af705502f50e0153dbcc5ac95b1183300000000000000000000000000000000000000000000000000000000000028004f0150bb13957e7d695f275826516f4ae3fffe2a8a90dacb9928f914bd394d19fdf9ec50e6ae28ebc5cc513f54c24e9d894fdec8e7ed06cf05e876edcfb51ae5bd534bb9500367bb183113ef108234c49a709f537b746d5cd5b7cb76a298093c2087fc1b39506d900641c75c03633dce2ed84fbe1ecb2e1ca8281d1204bf271341194ac8342f5040ef2daf531735bee90e5d577d596546b3b1c81cc9320325dcc2c2a3323d01e150b554613a6bfaf82baa12de8a197b0ffaa62987797093be828f5395c9e611246c50241cf2e2107e9552af9aca016371e35ea54215503e628a1ffe7a9b7594cfa0de48"
    root: "6eb803ef9c73e296e0078acef66b246704caded009a2a801d64544595b8abc0b"
    leaves: [
        ("0761481d357474bb7c4d7624ebd3bdb3d8355e73d11043fc0da3538000000000", "752e59e5856fcc30fb2c48ce32d10e9b03885303b250f1c37eab496e61e2506b"),
        ("5ad31649da4aa994c950516af0ca3881f91a0ba6da1598d5ba8af9729b7e8226", "a0f6ad8b61748d10fc35ada190eb19a0d6bcba98346edf4205bd62848ce110ae"),
        ("92562c3f7abafdaaa567d66a2517cc48546462c2b7fa15a5b2380ff7ac4ef9f3", "6b325989dca26a72b114280decd991bdededca0b32bade8240db4fcb2e9ade55")
    ]

    proof: "4c4ff551f55b1a5a404ebfc983b23a0ba3cba0bc20e8fb7ecfe6ce8da55346c01b196c6ac6c4d9c801cd7d2829581aefe84b6a754368e0aa9397fbd76363875a63307108004f014c4ff74851066219da8bfe824fdb5e2b5b37f73d0afaa76d285d65c34c8c0f1452fad96891a8000000000000000000000000000000000000000000000000000000000000d00050af9f3f2553576bab14c22f7a42cd5aea429d5f3096a895f3c89af33c3393321850f20109dd0ba9aeec178bcc2cad77d88f25d361b29dda5b5e84d3a9e0f51ef8ac506ea8b740a53bdcac14ac1239d25520ec5f30522d91ae80697d1f2cf5ca8b471650240042f461547f2cdfd34e7cc57b6eaf9c4b2cdd0383d23a08dd035e0c01c49b509a312ec6b88ae867d3de7c462065deabc26f5227f1c47bfa4b30acf6380780ae50cba7b783e6a1ea9bfcedd7fcd2cd6b3f12a6ca17c40edcc06d13a2983c6b7dfd4c4ff651035829020e2ef6b2d4677f8894e37972556af705502f50e0153dbcc5ac95b1183300000000000000000000000000000000000000000000000000000000000028004f0150c1e150b024bf31fe4f51d45911e16900281cbadecc40747c844ff78406f5322550e6ae28ebc5cc513f54c24e9d894fdec8e7ed06cf05e876edcfb51ae5bd534bb9500367bb183113ef108234c49a709f537b746d5cd5b7cb76a298093c2087fc1b39506d900641c75c03633dce2ed84fbe1ecb2e1ca8281d1204bf271341194ac8342f5056f541edddf046e34f194b20edef59e7687bc57b65075e0a4189cd8e1eeb11a550b554613a6bfaf82baa12de8a197b0ffaa62987797093be828f5395c9e611246c50241cf2e2107e9552af9aca016371e35ea54215503e628a1ffe7a9b7594cfa0de48"
    root: "485ca197b1ef658361e88ee2296fd0338709db6ab0a922acf905c3d8132da3f2"
    leaves: [
        ("92562c3f7abafdaaa567d66a2517cc48546462c2b7fa15a5b2380ff7ac4ef9f3", "269bfa07f128b9dbe80583ef3a8f6f96287c3d11f3090b7f4c2e048af261f002"),
        ("5ad31649da4aa994c950516af0ca3881f91a0ba6da1598d5ba8af9729b7e8226", "d7e9112a7f6ad3684bbed4b8b9033889cc12232459401c29d41b1f54de4c0d6e"),
        ("0761481d357474bb7c4d7624ebd3bdb3d8355e73d11043fc0da3538000000000", "752e59e5856fcc30fb2c48ce32d10e9b03885303b250f1c37eab496e61e2506b")
    ]
    */

    let proof0: &str = "4c4ff551f55b1a5a404ebfc983b23a0ba3cba0bc20e8fb7ecfe6ce8da55346c01b196c6ac6c4d9c801cd7d2829581aefe84b6a754368e0aa9397fbd76363875a63307108004f014c4ff74851066219da8bfe824fdb5e2b5b37f73d0afaa76d285d65c34c8c0f1452fad96891a8000000000000000000000000000000000000000000000000000000000000d00050af9f3f2553576bab14c22f7a42cd5aea429d5f3096a895f3c89af33c3393321850f20109dd0ba9aeec178bcc2cad77d88f25d361b29dda5b5e84d3a9e0f51ef8ac506ea8b740a53bdcac14ac1239d25520ec5f30522d91ae80697d1f2cf5ca8b471650240042f461547f2cdfd34e7cc57b6eaf9c4b2cdd0383d23a08dd035e0c01c49b503c72377fe7d057c7bc8ab964a00cbc699c08399b9c8fcc601a9865fa1f4b1f4450bd5faa039f16a100567372fdd133b71b4e5d104b52b1b5ff4e1637405f723b4f4c4ff651035829020e2ef6b2d4677f8894e37972556af705502f50e0153dbcc5ac95b1183300000000000000000000000000000000000000000000000000000000000028004f0150bb13957e7d695f275826516f4ae3fffe2a8a90dacb9928f914bd394d19fdf9ec50e6ae28ebc5cc513f54c24e9d894fdec8e7ed06cf05e876edcfb51ae5bd534bb9500367bb183113ef108234c49a709f537b746d5cd5b7cb76a298093c2087fc1b39506d900641c75c03633dce2ed84fbe1ecb2e1ca8281d1204bf271341194ac8342f5040ef2daf531735bee90e5d577d596546b3b1c81cc9320325dcc2c2a3323d01e150b554613a6bfaf82baa12de8a197b0ffaa62987797093be828f5395c9e611246c50241cf2e2107e9552af9aca016371e35ea54215503e628a1ffe7a9b7594cfa0de48";
    let root0: &str = "6eb803ef9c73e296e0078acef66b246704caded009a2a801d64544595b8abc0b";
    let leaves0: Vec<(&str, &str)> = vec![
        ("0761481d357474bb7c4d7624ebd3bdb3d8355e73d11043fc0da3538000000000",
         "752e59e5856fcc30fb2c48ce32d10e9b03885303b250f1c37eab496e61e2506b"),
        ("5ad31649da4aa994c950516af0ca3881f91a0ba6da1598d5ba8af9729b7e8226",
         "a0f6ad8b61748d10fc35ada190eb19a0d6bcba98346edf4205bd62848ce110ae"),
        ("92562c3f7abafdaaa567d66a2517cc48546462c2b7fa15a5b2380ff7ac4ef9f3",
         "6b325989dca26a72b114280decd991bdededca0b32bade8240db4fcb2e9ade55")];
    let result0: bool = MerkleVerify::verify_proof(proof0, root0, &leaves0);
    println!("result0: {}", result0);
    assert!(result0);


    let proof1: &str = "4c4ff551f55b1a5a404ebfc983b23a0ba3cba0bc20e8fb7ecfe6ce8da55346c01b196c6ac6c4d9c801cd7d2829581aefe84b6a754368e0aa9397fbd76363875a63307108004f014c4ff74851066219da8bfe824fdb5e2b5b37f73d0afaa76d285d65c34c8c0f1452fad96891a8000000000000000000000000000000000000000000000000000000000000d00050af9f3f2553576bab14c22f7a42cd5aea429d5f3096a895f3c89af33c3393321850f20109dd0ba9aeec178bcc2cad77d88f25d361b29dda5b5e84d3a9e0f51ef8ac506ea8b740a53bdcac14ac1239d25520ec5f30522d91ae80697d1f2cf5ca8b471650240042f461547f2cdfd34e7cc57b6eaf9c4b2cdd0383d23a08dd035e0c01c49b509a312ec6b88ae867d3de7c462065deabc26f5227f1c47bfa4b30acf6380780ae50cba7b783e6a1ea9bfcedd7fcd2cd6b3f12a6ca17c40edcc06d13a2983c6b7dfd4c4ff651035829020e2ef6b2d4677f8894e37972556af705502f50e0153dbcc5ac95b1183300000000000000000000000000000000000000000000000000000000000028004f0150c1e150b024bf31fe4f51d45911e16900281cbadecc40747c844ff78406f5322550e6ae28ebc5cc513f54c24e9d894fdec8e7ed06cf05e876edcfb51ae5bd534bb9500367bb183113ef108234c49a709f537b746d5cd5b7cb76a298093c2087fc1b39506d900641c75c03633dce2ed84fbe1ecb2e1ca8281d1204bf271341194ac8342f5056f541edddf046e34f194b20edef59e7687bc57b65075e0a4189cd8e1eeb11a550b554613a6bfaf82baa12de8a197b0ffaa62987797093be828f5395c9e611246c50241cf2e2107e9552af9aca016371e35ea54215503e628a1ffe7a9b7594cfa0de48";
    let root1: &str = "485ca197b1ef658361e88ee2296fd0338709db6ab0a922acf905c3d8132da3f2";
    let leaves1: Vec<(&str, &str)> = vec![
        ("92562c3f7abafdaaa567d66a2517cc48546462c2b7fa15a5b2380ff7ac4ef9f3",
         "269bfa07f128b9dbe80583ef3a8f6f96287c3d11f3090b7f4c2e048af261f002"),
        ("5ad31649da4aa994c950516af0ca3881f91a0ba6da1598d5ba8af9729b7e8226",
         "d7e9112a7f6ad3684bbed4b8b9033889cc12232459401c29d41b1f54de4c0d6e"),
        ("0761481d357474bb7c4d7624ebd3bdb3d8355e73d11043fc0da3538000000000",
         "752e59e5856fcc30fb2c48ce32d10e9b03885303b250f1c37eab496e61e2506b"),
    ];
    let result1: bool = MerkleVerify::verify_proof(proof1, root1, &leaves1);
    println!("result1: {}", result1);
    assert!(result1);
}


#[test]
fn test_merkle_verify() {
    /*
    proof: "4c4ff551f55b1a5a404ebfc983b23a0ba3cba0bc20e8fb7ecfe6ce8da55346c01b196c6ac6c4d9c801cd7d2829581aefe84b6a754368e0aa9397fbd76363875a63307108004f014c4ff74851066219da8bfe824fdb5e2b5b37f73d0afaa76d285d65c34c8c0f1452fad96891a8000000000000000000000000000000000000000000000000000000000000d00050af9f3f2553576bab14c22f7a42cd5aea429d5f3096a895f3c89af33c3393321850f20109dd0ba9aeec178bcc2cad77d88f25d361b29dda5b5e84d3a9e0f51ef8ac506ea8b740a53bdcac14ac1239d25520ec5f30522d91ae80697d1f2cf5ca8b471650240042f461547f2cdfd34e7cc57b6eaf9c4b2cdd0383d23a08dd035e0c01c49b503c72377fe7d057c7bc8ab964a00cbc699c08399b9c8fcc601a9865fa1f4b1f4450bd5faa039f16a100567372fdd133b71b4e5d104b52b1b5ff4e1637405f723b4f4c4ff651035829020e2ef6b2d4677f8894e37972556af705502f50e0153dbcc5ac95b1183300000000000000000000000000000000000000000000000000000000000028004f0150bb13957e7d695f275826516f4ae3fffe2a8a90dacb9928f914bd394d19fdf9ec50e6ae28ebc5cc513f54c24e9d894fdec8e7ed06cf05e876edcfb51ae5bd534bb9500367bb183113ef108234c49a709f537b746d5cd5b7cb76a298093c2087fc1b39506d900641c75c03633dce2ed84fbe1ecb2e1ca8281d1204bf271341194ac8342f5040ef2daf531735bee90e5d577d596546b3b1c81cc9320325dcc2c2a3323d01e150b554613a6bfaf82baa12de8a197b0ffaa62987797093be828f5395c9e611246c50241cf2e2107e9552af9aca016371e35ea54215503e628a1ffe7a9b7594cfa0de48"
    root: "6eb803ef9c73e296e0078acef66b246704caded009a2a801d64544595b8abc0b"
    leaves: [
        ("0761481d357474bb7c4d7624ebd3bdb3d8355e73d11043fc0da3538000000000", "752e59e5856fcc30fb2c48ce32d10e9b03885303b250f1c37eab496e61e2506b"),
        ("5ad31649da4aa994c950516af0ca3881f91a0ba6da1598d5ba8af9729b7e8226", "a0f6ad8b61748d10fc35ada190eb19a0d6bcba98346edf4205bd62848ce110ae"),
        ("92562c3f7abafdaaa567d66a2517cc48546462c2b7fa15a5b2380ff7ac4ef9f3", "6b325989dca26a72b114280decd991bdededca0b32bade8240db4fcb2e9ade55")
    ]

    proof: "4c4ff551f55b1a5a404ebfc983b23a0ba3cba0bc20e8fb7ecfe6ce8da55346c01b196c6ac6c4d9c801cd7d2829581aefe84b6a754368e0aa9397fbd76363875a63307108004f014c4ff74851066219da8bfe824fdb5e2b5b37f73d0afaa76d285d65c34c8c0f1452fad96891a8000000000000000000000000000000000000000000000000000000000000d00050af9f3f2553576bab14c22f7a42cd5aea429d5f3096a895f3c89af33c3393321850f20109dd0ba9aeec178bcc2cad77d88f25d361b29dda5b5e84d3a9e0f51ef8ac506ea8b740a53bdcac14ac1239d25520ec5f30522d91ae80697d1f2cf5ca8b471650240042f461547f2cdfd34e7cc57b6eaf9c4b2cdd0383d23a08dd035e0c01c49b509a312ec6b88ae867d3de7c462065deabc26f5227f1c47bfa4b30acf6380780ae50cba7b783e6a1ea9bfcedd7fcd2cd6b3f12a6ca17c40edcc06d13a2983c6b7dfd4c4ff651035829020e2ef6b2d4677f8894e37972556af705502f50e0153dbcc5ac95b1183300000000000000000000000000000000000000000000000000000000000028004f0150c1e150b024bf31fe4f51d45911e16900281cbadecc40747c844ff78406f5322550e6ae28ebc5cc513f54c24e9d894fdec8e7ed06cf05e876edcfb51ae5bd534bb9500367bb183113ef108234c49a709f537b746d5cd5b7cb76a298093c2087fc1b39506d900641c75c03633dce2ed84fbe1ecb2e1ca8281d1204bf271341194ac8342f5056f541edddf046e34f194b20edef59e7687bc57b65075e0a4189cd8e1eeb11a550b554613a6bfaf82baa12de8a197b0ffaa62987797093be828f5395c9e611246c50241cf2e2107e9552af9aca016371e35ea54215503e628a1ffe7a9b7594cfa0de48"
    root: "485ca197b1ef658361e88ee2296fd0338709db6ab0a922acf905c3d8132da3f2"
    leaves: [
        ("92562c3f7abafdaaa567d66a2517cc48546462c2b7fa15a5b2380ff7ac4ef9f3", "269bfa07f128b9dbe80583ef3a8f6f96287c3d11f3090b7f4c2e048af261f002"),
        ("5ad31649da4aa994c950516af0ca3881f91a0ba6da1598d5ba8af9729b7e8226", "d7e9112a7f6ad3684bbed4b8b9033889cc12232459401c29d41b1f54de4c0d6e"),
        ("0761481d357474bb7c4d7624ebd3bdb3d8355e73d11043fc0da3538000000000", "752e59e5856fcc30fb2c48ce32d10e9b03885303b250f1c37eab496e61e2506b")
    ]
    */

    let proof0: String = String::from("4c4ff551f55b1a5a404ebfc983b23a0ba3cba0bc20e8fb7ecfe6ce8da55346c01b196c6ac6c4d9c801cd7d2829581aefe84b6a754368e0aa9397fbd76363875a63307108004f014c4ff74851066219da8bfe824fdb5e2b5b37f73d0afaa76d285d65c34c8c0f1452fad96891a8000000000000000000000000000000000000000000000000000000000000d00050af9f3f2553576bab14c22f7a42cd5aea429d5f3096a895f3c89af33c3393321850f20109dd0ba9aeec178bcc2cad77d88f25d361b29dda5b5e84d3a9e0f51ef8ac506ea8b740a53bdcac14ac1239d25520ec5f30522d91ae80697d1f2cf5ca8b471650240042f461547f2cdfd34e7cc57b6eaf9c4b2cdd0383d23a08dd035e0c01c49b503c72377fe7d057c7bc8ab964a00cbc699c08399b9c8fcc601a9865fa1f4b1f4450bd5faa039f16a100567372fdd133b71b4e5d104b52b1b5ff4e1637405f723b4f4c4ff651035829020e2ef6b2d4677f8894e37972556af705502f50e0153dbcc5ac95b1183300000000000000000000000000000000000000000000000000000000000028004f0150bb13957e7d695f275826516f4ae3fffe2a8a90dacb9928f914bd394d19fdf9ec50e6ae28ebc5cc513f54c24e9d894fdec8e7ed06cf05e876edcfb51ae5bd534bb9500367bb183113ef108234c49a709f537b746d5cd5b7cb76a298093c2087fc1b39506d900641c75c03633dce2ed84fbe1ecb2e1ca8281d1204bf271341194ac8342f5040ef2daf531735bee90e5d577d596546b3b1c81cc9320325dcc2c2a3323d01e150b554613a6bfaf82baa12de8a197b0ffaa62987797093be828f5395c9e611246c50241cf2e2107e9552af9aca016371e35ea54215503e628a1ffe7a9b7594cfa0de48");
    let root0: String = String::from("6eb803ef9c73e296e0078acef66b246704caded009a2a801d64544595b8abc0b");
    let leaves0: Vec<(String, String)> = vec![
        (String::from("0761481d357474bb7c4d7624ebd3bdb3d8355e73d11043fc0da3538000000000"),
         String::from("752e59e5856fcc30fb2c48ce32d10e9b03885303b250f1c37eab496e61e2506b")),
        (String::from("5ad31649da4aa994c950516af0ca3881f91a0ba6da1598d5ba8af9729b7e8226"),
         String::from("a0f6ad8b61748d10fc35ada190eb19a0d6bcba98346edf4205bd62848ce110ae")),
        (String::from("92562c3f7abafdaaa567d66a2517cc48546462c2b7fa15a5b2380ff7ac4ef9f3"),
         String::from("6b325989dca26a72b114280decd991bdededca0b32bade8240db4fcb2e9ade55"))];
    let result0: bool = MerkleVerify::merkle_verify(proof0, root0, leaves0);
    println!("result0: {}", result0);
    assert!(result0);


    let proof1: String = String::from("4c4ff551f55b1a5a404ebfc983b23a0ba3cba0bc20e8fb7ecfe6ce8da55346c01b196c6ac6c4d9c801cd7d2829581aefe84b6a754368e0aa9397fbd76363875a63307108004f014c4ff74851066219da8bfe824fdb5e2b5b37f73d0afaa76d285d65c34c8c0f1452fad96891a8000000000000000000000000000000000000000000000000000000000000d00050af9f3f2553576bab14c22f7a42cd5aea429d5f3096a895f3c89af33c3393321850f20109dd0ba9aeec178bcc2cad77d88f25d361b29dda5b5e84d3a9e0f51ef8ac506ea8b740a53bdcac14ac1239d25520ec5f30522d91ae80697d1f2cf5ca8b471650240042f461547f2cdfd34e7cc57b6eaf9c4b2cdd0383d23a08dd035e0c01c49b509a312ec6b88ae867d3de7c462065deabc26f5227f1c47bfa4b30acf6380780ae50cba7b783e6a1ea9bfcedd7fcd2cd6b3f12a6ca17c40edcc06d13a2983c6b7dfd4c4ff651035829020e2ef6b2d4677f8894e37972556af705502f50e0153dbcc5ac95b1183300000000000000000000000000000000000000000000000000000000000028004f0150c1e150b024bf31fe4f51d45911e16900281cbadecc40747c844ff78406f5322550e6ae28ebc5cc513f54c24e9d894fdec8e7ed06cf05e876edcfb51ae5bd534bb9500367bb183113ef108234c49a709f537b746d5cd5b7cb76a298093c2087fc1b39506d900641c75c03633dce2ed84fbe1ecb2e1ca8281d1204bf271341194ac8342f5056f541edddf046e34f194b20edef59e7687bc57b65075e0a4189cd8e1eeb11a550b554613a6bfaf82baa12de8a197b0ffaa62987797093be828f5395c9e611246c50241cf2e2107e9552af9aca016371e35ea54215503e628a1ffe7a9b7594cfa0de48");
    let root1: String = String::from("485ca197b1ef658361e88ee2296fd0338709db6ab0a922acf905c3d8132da3f2");
    let leaves1: Vec<(String, String)> = vec![
        (String::from("92562c3f7abafdaaa567d66a2517cc48546462c2b7fa15a5b2380ff7ac4ef9f3"),
         String::from("269bfa07f128b9dbe80583ef3a8f6f96287c3d11f3090b7f4c2e048af261f002")),
        (String::from("5ad31649da4aa994c950516af0ca3881f91a0ba6da1598d5ba8af9729b7e8226"),
         String::from("d7e9112a7f6ad3684bbed4b8b9033889cc12232459401c29d41b1f54de4c0d6e")),
        (String::from("0761481d357474bb7c4d7624ebd3bdb3d8355e73d11043fc0da3538000000000"),
         String::from("752e59e5856fcc30fb2c48ce32d10e9b03885303b250f1c37eab496e61e2506b")),
    ];
    let result1: bool = MerkleVerify::merkle_verify(proof1, root1, leaves1);
    println!("result1: {}", result1);
    assert!(result1);
}
